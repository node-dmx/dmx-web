html

  head

    meta(charset="utf-8")
    meta(name="viewport" content="width=device-width, initial-scale=1.0")
    meta(name="apple-mobile-web-app-capable" content="yes")

    title DMX WEB

    link(rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous")
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">

    link(rel="stylesheet" href="/css/main.css")

    script(src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous")
    script(src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous")
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js" integrity="sha256-4iQZ6BVL4qNKlQ27TExEhBN1HFPvAvAMbFavKKosSWQ=" crossorigin="anonymous"></script>
    script(src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous")
    script(src="/socket.io/socket.io.js")

  body

    nav.navbar.navbar-expand-lg.navbar-light.bg-light
      a.navbar-brand(href="#") DMX WEB
      
      button(class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false" aria-label="Toggle navigation")
        span(class="navbar-toggler-icon")

      div(class="collapse navbar-collapse" id="main-navbar")
        ul(class="navbar-nav mr-auto")
          li(class="nav-item active")
            a(class="nav-link" href="#control") Control
          
          - if(!!config.allowEditing)
            li(class="nav-item")
              a(class="nav-link" href="#edit") Editor
          
          li(class="nav-item")
            a(class="nav-link" href="#sliders") Simple Sliders

        button.btn.btn-danger.dmx-scene-trigger(scene_id="default-blackout")="Blackout"
        

    div(class="tab-content" id="main-content-tabs")
      div(class="tab-pane" id="home")
          p tab1
      div(class="tab-pane" id="control")
        br
        .container-fluid
          .row
            - for(let i = 0 ; i < scenes.length; i++)
              - if(scenes[i].hidden) continue
              .col-md-2.col-sm-3
                .dmx-scene-trigger-container
                  button.btn-block.btn.btn-lg.btn-secondary.dmx-scene-trigger.dmx-scene-trigger-control(scene_id=scenes[i].id style=("color" in scenes[i] ? "border-color: " + scenes[i].color + "; background-color: " + scenes[i].color : ""))=scenes[i].label

      - if(!!config.allowEditing)
        div.tab-pane(id="edit")

          // Step Editor Modal

          .modal.fade#editor-scene-step-editor-modal(tabindex="-1" role="dialog" aria-labelledby="editor-scene-step-editor-modal" aria-hidden="true")
            .modal-dialog(role="document")
              .modal-content
                .modal-header
                  h5.modal-title Edit Step
                  button.close(type="button" data-dismiss="modal" aria-label="Close")
                    span(aria-hidden="true") &times;
                .modal-body
                  form
                    .form-group
                      label.col-form-label Delay (ms):
                      input.form-control#editor-scene-step-editor-modal-delay(type="number")
                .modal-footer
                  button.btn.btn-secondary(type="button" data-dismiss="modal") Close
                  button.btn.btn-primary#editor-scene-step-editor-modal-save(type="button" data-dismiss="modal") Save

          // New Animation Modal

          .modal.fade#editor-scene-creator-modal(tabindex="-1" role="dialog" aria-labelledby="editor-scene-creator-modal" aria-hidden="true")
            .modal-dialog(role="document")
              .modal-content
                .modal-header
                  h5.modal-title New Scene
                  button.close(type="button" data-dismiss="modal" aria-label="Close")
                    span(aria-hidden="true") &times;
                .modal-body
                  form
                    .form-group
                      label.col-form-label Name:
                      input.form-control#editor-scene-creator-modal-name(type="text", placeholder="Scene Name")
                .modal-footer
                  button.btn.btn-secondary(type="button" data-dismiss="modal") Close
                  button.btn.btn-primary#editor-scene-modal-save(type="button" data-dismiss="modal") Add

          // New Device Modal
          .modal.fade#editor-add-device-modal(tabindex="-1" role="dialog" aria-labelledby="editor-add-device-modal" aria-hidden="true")
            .modal-dialog(role="document")
              .modal-content
                .modal-header
                  h5.modal-title New Device
                  button.close(type="button" data-dismiss="modal" aria-label="Close")
                    span(aria-hidden="true") &times;
                .modal-body
                  form
                    .form-group
                      label.col-form-label Name:
                      input.form-control#editor-add-device-modal-name(type="text", placeholder="Device Name")
                    .form-group
                      label.col-form-label Type:
                      select.form-control#editor-add-device-modal-type
                        each option, index in deviceTypes
                          option=index
                    .form-group
                      label.col-form-label Address:
                      input.form-control#editor-add-device-modal-address(type="number", value=1, min=1, max=512)

                .modal-footer
                  button.btn.btn-secondary(type="button" data-dismiss="modal") Close
                  button.btn.btn-primary#editor-device-modal-save(type="button" data-dismiss="modal") Add

          // Main editor
          .container-fluid

            br

            .row
              .col-lg-9
                .row
                  .col-md-3.col-sm-4
                    .card.bg-dark.text-white
                      .card-header
                        h2
                          span Scenes
                          button.btn.btn-info.float-right(data-toggle="modal" data-target="#editor-scene-creator-modal")
                            i.fas.force-parent-lh.fa-plus
                      .list-group
                        each scene, index in scenes
                          if !scene.hidden && !scene.legacy
                            button.list-group-item.list-group-item-action.bg-dark.text-white.editor-scene-selector(scene_id=scene.id)=scene.label

                  .col-md-9.col-sm-8

                    .card.bg-dark.text-white#editor-scene-help
                      .card-body.text-center
                        br
                        h5.text-secondary Select a scene from the left to edit, or:
                        br
                        button.btn.btn-info.btn-lg(data-toggle="modal" data-target="#editor-scene-creator-modal") Create A New Scene
                        br
                        br

                    .card.bg-dark.text-white#editor-scene-editor(style="display: none;")
                      .card-header
                        h1
                          span#editor-scene-title Scene Title
                          button.btn.btn-danger.btn-lg.float-right#editor-scene-delete
                            i.fas.force-parent-lh.fa-trash-alt
                      .card-body
                        
                        h4 Static
                        br
                        div.row
                          div.col-sm-4
                            p Universe
                          div.col-sm-4
                            p Channel
                          div.col-sm-3
                            p Value
                          div.col-sm-1
                        div#editor-scene-static
                          p.text-secondary.text-center No Static Values 

                        br

                        button.btn.btn-secondary.btn-block#editor-scene-add-static Add Static Value

                        hr

                        h4 Animations
                        br
                        div#editor-scene-animations
                          p.text-secondary.text-center No Animations

                        br

                        button.btn.btn-secondary.btn-block#editor-scene-add-animation Add Animation

                      .card-footer
                        button.btn.btn-primary#editor-scene-save Save

              .col-lg-3
                .card.bg-dark.text-white
                  .card-header
                    h2
                      span Devices
                      button.btn.btn-info.float-right(data-toggle="modal" data-target="#editor-add-device-modal")
                        i.fas.force-parent-lh.fa-plus
                  .list-group
                    each device,index in devices
                      li.list-group-item.bg-dark.text-white
                        div
                          span.badge.badge-primary #{device.address}-#{Number(device.address) + (device.channels.length - 1)}
                          span.mr-2.ml-2 - 
                          span=device.label
                          button.btn.btn-danger.btn-sm.float-right.editor-device-delete(editor-device-id=device.id)
                            i.fas.force-parent-lh.fa-trash-alt
                        div
                          .col-sm-11.offset-md-1
                            table.table-sm.table-borderless.text-white
                              each channel, k in device.channels
                                tr
                                  td
                                    span.badge.badge-secondary #{Number(device.address) + k}
                                  td.w-100.text-left
                                    if ["pan", "pan-fine"].indexOf(channel) !== -1
                                      i.fas.fa-arrows-alt-h.mr-2
                                    if ["tilt", "tilt-fine"].indexOf(channel) !== -1
                                      i.fas.fa-arrows-alt-v.mr-2
                                    if ["move-speed"].indexOf(channel) !== -1
                                      i.fas.fa-tachometer-alt.mr-2
                                    if ["static-color"].indexOf(channel) !== -1
                                      i.fas.fa-palette.mr-2
                                    if ["program", "effect"].indexOf(channel) !== -1
                                      i.fas.fa-certificate.mr-2
                                    if ["dimmer", "strobe", "dimmer-strobe-combo"].indexOf(channel) !== -1
                                      i.fas.fa-lightbulb.mr-2
                                    if ["gobo-selector"].indexOf(channel) !== -1
                                      i.fas.fa-cookie.mr-2
                                    if channel == "red" || channel.match(/^red\d+$/g)
                                      i.fas.fa-circle.text-danger.mr-2
                                    if channel == "green" || channel.match(/^green\d+$/g)
                                      i.fas.fa-circle.text-success.mr-2
                                    if channel == "blue" || channel.match(/^blue\d+$/g)
                                      i.fas.fa-circle.text-primary.mr-2
                                    if channel == "white" || channel.match(/^white\d+$/g)
                                      i.fas.fa-circle.mr-2
                                    =channel

      div(class="tab-pane" id="sliders")
        br
        .container
          .dmx-container
            each _, channel in Array(512)
              .dmx-fader
                input(class="dmx-channel" type="range" orient="vertical" universe="office" channel=channel+1 min=0 max=255)
                .dmx-label
                  =channel+1



  script(src="/js/navbar.js")
  script(src="/js/socket.js")
  script(src="/js/slider.js")
  script(src="/js/control.js")
  script(src="/js/editor/editor-renderer.js")
  script(src="/js/editor/editor.js")
  script(src="/js/main.js")
